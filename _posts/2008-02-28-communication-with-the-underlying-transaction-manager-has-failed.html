---
comments: true
share: true
layout: post
title: Communication with the underlying transaction manager has failed
categories:
- shortpost
tags:
- msdtc
status: publish
type: post
published: true
meta: {}
author:
  login: david
  email: dvilchezm@gmail.com
  display_name: David Vílchez Mendoza
  first_name: David
  last_name: Vílchez Mendoza
---
<p><strong>El problema:</strong></p>
<p><em>"Hola,</em></p>
<p><em>Tengo un problema con el msdtc y me preguntaba si tal vez podíais</em></p>
<p><em>echarme un cable. Estoy haciendo una aplicación Windows form, la base</em></p>
<p><em>de datos esta en un Windows 2003 server (service pack 1) y el web</em></p>
<p><em>service en un Windows xp(service pack 2). El problema viene con las</em></p>
<p><em>transacciones dtc que me lanzan un error:</em></p>
{% highlight csharp %}
Mensaje: Error de comunicación con el administrador de transacciones
subyacente.
Source:
Traza:
HelpLink:
--------------------------------------------------------
InnerException
--------------------------------------------------------
Mensaje: Error de comunicación con el administrador de transacciones
subyacente.
Source: System.Data
Traza: en
System.Data.Common.DbDataAdapter.UpdatedRowStatusErrors(RowUpdatedEventArgs
rowUpdatedEvent, BatchCommandInfo[] batchCommands, Int32 commandCount)
en
System.Data.Common.DbDataAdapter.UpdatedRowStatus(RowUpdatedEventArgs
rowUpdatedEvent, BatchCommandInfo[] batchCommands, Int32 commandCount)
en System.Data.Common.DbDataAdapter.Update(DataRow[] dataRows,
DataTableMapping tableMapping) en
System.Data.Common.DbDataAdapter.UpdateFromDataTable(DataTable
dataTable, DataTableMapping tableMapping) en
System.Data.Common.DbDataAdapter.Update(DataTable dataTable) en
Encuesta.CapaEntidad.EncuestaDSTableAdapters.PRG_PREGUNTATableAdapter.Update(PRG_PREGUNTADataTable
dataTable) en Encuesta.CapaDatos.EncuestaAD.Actualizar(EncuestaDS
Encuesta) en Encuesta.CapaNegocio.EncuestaCN.Actualizar(EncuestaDS
Encuesta)
TargetSite: Void
UpdatedRowStatusErrors(System.Data.Common.RowUpdatedEventArgs,
BatchCommandInfo[], Int32)
HelpLink:
Este error esta más que documentado así que me descargue el dtcping
para que me ayudara a resolverlo. El dtcping me da el siguiente error:
Problem:fail to invoke remote RPC method
Error(0x6D9) at dtcping.cpp @303
-->RPC pinging exception
-->1753(There are no more endpoints available from the endpoint
mapper.)
RPC test failed
{% endhighlight %}
<p><em>También esta documentado (<a href="http://support.microsoft.com/?id=839880">http://support.microsoft.com/?id=839880</a>)</em></p>
<p><em>pero he seguido esta guía al pie de la letra y no he avanzado nada,</em></p>
<p><em>¿ha alguien se le ocurre que más puedo hacer?</em></p>
<p><em>Muchas gracias si has llegado hasta aquí leyendo. :P"</em></p>
<p><strong>La solución:</strong></p>
<p>1º Añadir al servidor “Enable Network DTC Access “</p>
<p><a href="{{ site.url }}/images/uploads/2008/02/dtc.JPG" title="dtc.JPG"><img src="{{ site.url }}/images/uploads/2008/02/dtc.JPG" alt="dtc.JPG" /></a></p>
<p>2º Habilitar en el cliente y en el servidor “Enable COM Internet Services on this computer”</p>
<p><a href="{{ site.url }}/images/uploads/2008/02/com.JPG" title="com.JPG"><img src="{{ site.url }}/images/uploads/2008/02/com.JPG" alt="com.JPG" /></a></p>
<p>Fuentes:</p>
<p><a href="http://www.malagadnug.org/">Málaga .NET User Group</a></p>
<p><a href="http://www.webservertalk.com/message458751.html">www.webservertalk.com</a></p>
